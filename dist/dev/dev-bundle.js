!function(){"use strict";const e=e=>"connection"in navigator?e.indexOf(navigator.connection.effectiveType)>=0?"slow":"fast":"unknown",t=e=>null!==sessionStorage.getItem(e),n=e=>{try{return t(e)?JSON.parse(sessionStorage.getItem(e)):{}}catch(e){return console.log(e),0}},o=(e,t)=>{try{sessionStorage.setItem(t,JSON.stringify(e))}catch(e){console.log(e)}};const a=(e,t)=>{o(e,t),function(e){const t=n(e),o=document.getElementsByTagName("html")[0];Object.entries(t).forEach((e=>{const[t,n]=e,a=`${t}-${n}`;o.classList.add(a)}))}(t)},s=t=>{const{lowRAM:n,lowCPU:o,slowConnectionTypes:a}=t;return{memoryLevel:(e=>{if(!("deviceMemory"in navigator))return"unknown";const t=navigator.deviceMemory;return t===e?"mid":t>e?"high":"low"})(n),cpuLevel:(e=>{if(!("hardwareConcurrency"in navigator))return"unknown";const t=navigator.hardwareConcurrency;return t===e?"mid":t>e?"high":"low"})(o),connectionSpeed:e(a),saveData:"connection"in navigator?navigator.connection.saveData:0,reducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches,doNotTrack:(()=>{const e="doNotTrack"in navigator,t="1"===navigator.doNotTrack;return e&&t})()}},l="settingsModal",i=l,r="settingsModal--open",d="settingsModal--closed",c="settingsModal--banner",u="settingsModal__header",p="settingsModal__logo",g="settingsModal__footer",m="settingsModal__footerLink",v="settingsModal__title",f="settingsModal__form",$="settingsModal__submit",h="settingsModal__options",w="settingsModal__option",y="settingsModal__controller",b="settingsModal__controller--toggle",C="settingsModal__controller--options",_="settingsModal__controller--view",k="settingsModal__parameter",M="settingsModal__parameterValue",L="settingsModal__parameterInput",S="settingsModal__input",x="settingsModal__label",D="settingsModal__toggle",E="settingsModal__toggle--view",T="settingsModal__slider",U="settingsModal__icon",A="settingsModal__closeIcon",I="settingsModal__openIcon",O={settingsModalSubmitId:"settingsModalSubmit",settingsModalFormId:"settingsModalForm"},V={title:"memory level",id:"settingsModalMemoryLevel",valuePrefix:"memory-level",options:[{type:"radio",id:"memory-level-low",name:"memoryLevel",value:"low",label:"low"},{type:"radio",id:"memory-level-mid",name:"memoryLevel",value:"mid",label:"mid"},{type:"radio",id:"memory-level-high",name:"memoryLevel",value:"high",label:"high"},{type:"radio",id:"memory-level-unknown",name:"memoryLevel",value:"unknown",label:"unknown"}]},q={title:"CPU level",id:"settingsModalCpuLevel",valuePrefix:"cpu-level",options:[{type:"radio",id:"cpu-level-low",name:"cpuLevel",value:"low",label:"low"},{type:"radio",id:"cpu-level-mid",name:"cpuLevel",value:"mid",label:"mid"},{type:"radio",id:"cpu-level-high",name:"cpuLevel",value:"high",label:"high"},{type:"radio",id:"cpu-level-unknown",name:"cpuLevel",value:"unknown",label:"unknown"}]},G={title:"Connection speed",id:"settingsModalConnectionSpeed",valuePrefix:"connection-speed",options:[{type:"radio",id:"connection-speed-slow",name:"connectionSpeed",value:"slow",label:"slow"},{type:"radio",id:"connection-speed-fast",name:"connectionSpeed",value:"fast",label:"fast"},{type:"radio",id:"connection-speed-unknown",name:"connectionSpeed",value:"unknown",label:"unknown"}]},N={title:"Save data",id:"saveData",name:"saveData",value:"true",checkedValue:"true",uncheckedValue:"false"},P={title:"Reduced motion",id:"reducedMotion",name:"reducedMotion",value:"true",checkedValue:"true",uncheckedValue:"false"},j={title:"Do not track",id:"doNotTrack",name:"doNotTrack",value:"true",checkedValue:"true",uncheckedValue:"false"},B={memoryLevel:V,cpuLevel:q,connectionSpeed:G},F={saveData:N,reducedMotion:P,doNotTrack:j},K={websiteLabel:"www.progux.org",websiteUrl:"http://progux.org/",banner:"Banner view",simulator:"Simulator view",id:"view",name:"view",value:"disabled",checkedValue:"enabled",uncheckedValue:"disabled"};function J(e){const t=function(e){let t="";return e.forEach((e=>{t+=`<li class="${w}">\n        <input type="${e.type}" id="${e.id}" class="${S}" name="${e.name}" value="${e.value}">\n        <label for="${e.id}" class="${x}">${e.label}</label>\n    </li>`})),t}(e.options);return`<div class="${y} ${C}">\n    <p class="${k}">${e.title}</p>\n    <p class="${M}"></p>\n    <ul class="${h} ${L}" id="${e.id}">\n        ${t}\n    </ul>\n  </div>`}function R(e){return`<div class="${y} ${b}">\n    <p class="${k}">${e.title}</p>\n    <p class="${M}">${e.value}</p>\n    <label class="${D} ${L}">\n      <input type="checkbox" \n              id="${e.id}" \n              class="${S}"\n              name="${e.name}" \n              value="${e.value}"\n              data-checked-value="${e.checkedValue}"\n              data-unchecked-value="${e.uncheckedValue}">\n      <span class="${T}"></span>\n    </label>\n  </div>`}const Z=e=>{const t=function(e){const{mode:t,posTop:n,posLeft:o,isDraggable:a}=e;let s="closed"===t?`${i}--closed`:`${i}--open`;return"banner"===t&&(s+=` ${i}--banner`),`<div class="${i} ${s}"\n               style="top: ${n}px; left: ${o}px;"\n               id="${i}" \n               draggable="${a?"true":"false"}">`}(e),n=`<button type="submit" class="${$}" id="${O.settingsModalSubmitId}" value="Submit">Update</button>`;return`${t}\n    ${`<div class="${u}">\n    <span class="${p}">\n      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 84.31 81.88">\n  <defs>\n    <style>.cls-1{fill:url(#Degradado_sin_nombre_13);}.cls-2{fill:url(#Degradado_sin_nombre_7);}.cls-3{fill:url(#Degradado_sin_nombre_92);}.cls-4{fill:url(#Degradado_sin_nombre_83);}</style>\n    <linearGradient id="Degradado_sin_nombre_13" y1="26.8" x2="84.21" y2="26.8" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e74b1e"/><stop offset="0.2" stop-color="#ec6a22"/><stop offset="0.97" stop-color="#f7ab2d"/></linearGradient>\n    <linearGradient id="Degradado_sin_nombre_7" x1="14.92" y1="30.45" x2="84.31" y2="30.45" gradientUnits="userSpaceOnUse"><stop offset="0.1" stop-color="#e74b1e"/><stop offset="0.97" stop-color="#f7ab2d"/></linearGradient>\n    <linearGradient id="Degradado_sin_nombre_92" x1="124.58" y1="631.8" x2="208.86" y2="631.8" gradientTransform="translate(208.89 688) rotate(180)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#2d2e82"/><stop offset="0.14" stop-color="#2a3c8d"/><stop offset="1" stop-color="#1d70b7"/></linearGradient>\n    <linearGradient id="Degradado_sin_nombre_83" x1="139.5" y1="634.54" x2="208.89" y2="634.54" gradientTransform="translate(208.89 688) rotate(180)" gradientUnits="userSpaceOnUse"><stop offset="0.11" stop-color="#2d2e82"/><stop offset="1" stop-color="#1d70b7"/></linearGradient>\n  </defs>\n  <g id="Capa_2" data-name="Capa 2"><g id="Capa_1-2" data-name="Capa 1"><path class="cls-1" d="M0,44.05C0,19.76,19,0,42.29,0,63,0,81,16.05,84.1,37.34a9.5,9.5,0,0,1-7.68,10.89,9.23,9.23,0,0,1-10.45-8C64.2,28.19,54,19.11,42.29,19.11c-13.2,0-23.95,11.19-23.95,24.94A9.36,9.36,0,0,1,9.17,53.6,9.37,9.37,0,0,1,0,44.05"/><path class="cls-2" d="M24.1,52.39a9.16,9.16,0,0,1-9.18-9.15A34.85,34.85,0,0,1,84.2,38,9.18,9.18,0,0,1,66,40.72a16.48,16.48,0,0,0-32.75,2.52A9.16,9.16,0,0,1,24.1,52.39Z"/><path class="cls-3" d="M84.31,39.68A42.34,42.34,0,0,1,.14,46.1a9.18,9.18,0,0,1,18.15-2.77A24,24,0,0,0,66,39.68a9.18,9.18,0,0,1,18.36,0"/><path class="cls-4" d="M60.2,31.52a9.17,9.17,0,0,1,9.18,9.15A34.85,34.85,0,0,1,.11,46a9.18,9.18,0,0,1,18.15-2.77A16.48,16.48,0,0,0,51,40.67,9.17,9.17,0,0,1,60.2,31.52Z"/></g></g>\n</svg>\n    </span>\n    <p class="${v}">Simulator</p>\n    <span class="${U} ${A}">\n      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 30 30">\n  <path fill-rule="evenodd" d="M30 3.021L26.979 0 15 11.979 3.021 0 0 3.021 11.979 15 0 26.979 3.021 30 15 18.021 26.979 30 30 26.979 18.021 15z"/>\n</svg>\n    </span>\n    <span class="${U} ${I}">\n      <svg width="30px" height="30px" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <defs>\n        <radialGradient cx="50%" cy="50%" fx="50%" fy="50%" r="71.2561845%" gradientTransform="translate(0.500000,0.500000),scale(1.000000,0.992190),translate(-0.500000,-0.500000)" id="radialGradient-1">\n            <stop stop-color="#E84B1E" offset="0%"></stop>\n            <stop stop-color="#F8AC2E" offset="100%"></stop>\n        </radialGradient>\n    </defs>\n    <g id="Widget" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="noun_function_934624-copy" transform="translate(0.000000, -1.000000)" fill="url(#radialGradient-1)" fill-rule="nonzero">\n            <g id="Group" transform="translate(0.000000, 0.518433)">\n                <path d="M18.8809451,0.603618513 C20.2675305,0.978837908 21.4172256,1.42487077 22.4503049,1.98815969 L21.6948171,4.90576638 C21.6467988,5.09567522 21.7227134,5.29524043 21.885061,5.40375977 C22.8756098,6.06499199 23.7618902,6.87198958 24.51875,7.802221 C24.6275915,7.93649068 24.7327744,8.07305951 24.8356707,8.21008816 C24.9568598,8.37056802 25.166311,8.43310459 25.3547256,8.36596975 L25.9689024,8.14525245 C26.6128049,7.91487878 27.3609756,7.65185734 28.128811,7.40722901 C28.8147866,8.46253356 29.3452744,9.60152675 29.7417683,10.8720307 L27.1679878,12.4046363 C26.9992378,12.5053386 26.9128049,12.7026047 26.9535061,12.8957323 C27.208689,14.1004809 27.2754573,15.3406361 27.152439,16.5798718 C27.135061,16.7509277 27.1144817,16.9201443 27.0897866,17.088901 C27.0614329,17.2857073 27.1625,17.4783751 27.339939,17.566662 L29.9782012,18.8790102 C29.6681402,20.2663104 29.1198171,21.516122 28.6254573,22.5121088 L25.7804878,21.7418974 C25.5907012,21.6899369 25.3871951,21.7676478 25.2783537,21.935025 C24.6115854,22.9627399 23.7911585,23.8800962 22.841311,24.6613434 C22.7402439,24.7441124 22.6387195,24.8245822 22.5349085,24.9050521 C22.379878,25.0250671 22.3176829,25.2310699 22.38125,25.4173001 L23.336128,28.2365037 C22.316311,28.9262452 21.1679878,29.4693017 19.8458841,29.8877449 L18.3842988,27.3071919 C18.2846037,27.1319976 18.0815549,27.0404919 17.8871951,27.0864747 C16.6579268,27.3623713 15.3829268,27.4382428 14.1097561,27.3108706 C13.9579268,27.2956963 13.8070122,27.2763835 13.6570122,27.2556912 C13.4553354,27.2285614 13.2664634,27.3352414 13.1814024,27.5164135 C12.8041159,28.3289291 12.3824695,29.1791505 11.8579268,30.1861731 C11.7618902,30.157204 11.6658537,30.1291545 11.5693598,30.1015648 C10.4653963,29.7902615 9.42362805,29.4007874 8.47286585,28.942799 C8.40746951,28.9115308 8.34390244,28.8765839 8.28033537,28.8411771 L9.02256098,25.9557584 C9.07195122,25.7635504 8.99375,25.561686 8.8277439,25.4536265 C8.72942073,25.3901703 8.63246951,25.3253346 8.53734756,25.2595792 C7.61722561,24.6222581 6.78856707,23.8534262 6.07469512,22.9765348 L5.97042683,22.8468634 C5.91554878,22.7769695 5.8625,22.7070757 5.80853659,22.6358024 C5.68871951,22.4776217 5.48155488,22.4132458 5.29496951,22.4785414 L2.48155488,23.4492376 C1.77865854,22.2651813 1.25503049,21.1197506 0.89054878,19.9660429 C1.70091463,19.4804648 2.5382622,18.9921278 3.43871951,18.47942 C3.61387195,18.3796373 3.70304878,18.1768533 3.65960366,17.9795873 C3.38612805,16.7449499 3.31204268,15.4726067 3.43963415,14.1965849 C3.4570122,14.02277 3.4785061,13.8503346 3.50320122,13.678359 C3.53109756,13.4829323 3.43185976,13.291644 3.25625,13.2024374 L0.626676829,11.8680174 C0.667835366,11.6919034 0.708993902,11.5185484 0.757012195,11.3470327 C0.919817073,10.7699489 1.0867378,10.1937848 1.26463415,9.62313865 C1.31676829,9.45576137 1.39771341,9.28608495 1.48963415,9.09801543 C1.61722561,8.83821278 1.74893293,8.58024945 1.88292683,8.31814767 L1.92454268,8.23629834 C2.84420732,8.46621218 3.7625,8.72509517 4.65381098,8.97616109 L4.81570122,9.02168403 C5.00731707,9.07502404 5.21219512,8.99823282 5.3214939,8.83039571 C5.98597561,7.80819876 6.80365854,6.89498097 7.75121951,6.11603286 C7.89435976,5.9987768 8.03841463,5.88519936 8.18521341,5.77484071 C8.34573171,5.65482569 8.4097561,5.4442246 8.34435976,5.25431577 L7.36295732,2.42959427 C7.84496951,2.09621919 8.35304878,1.82124224 8.8757622,1.61156081 C8.98780488,1.5664977 9.09618902,1.51315768 9.20411585,1.45889802 L9.2589939,1.43130836 C9.72042683,1.20369365 10.2390244,1.00918654 10.8403963,0.837670807 L12.3426829,3.44351433 C12.4414634,3.61594971 12.6385671,3.70561611 12.8329268,3.66331196 C14.0237805,3.40902725 15.2557927,3.34327189 16.4827744,3.46650571 C16.6908537,3.48719796 16.897561,3.51432779 17.1028963,3.54559607 C17.3068598,3.57502505 17.5003049,3.47018433 17.5862805,3.28579343 C18.0294207,2.3321108 18.4373476,1.46257664 18.8809451,0.603618513 Z M11.8291159,15.0399088 C11.7362805,15.9710599 12.0097561,16.883358 12.5992378,17.6080465 C13.1887195,18.3322751 14.0233232,18.7829062 14.9503049,18.8762513 C15.0682927,18.8877469 15.1849085,18.8937247 15.3006098,18.8937247 C17.0969512,18.8937247 18.5864329,17.537233 18.7647866,15.7383871 C18.857622,14.807236 18.583689,13.8949379 17.9942073,13.1707093 C17.4047256,12.445561 16.570122,11.9953897 15.6440549,11.9020447 C13.7045732,11.7066179 12.0193598,13.1251863 11.8291159,15.0399088 Z" id="Combined-Shape"></path>\n            </g>\n        </g>\n    </g>\n</svg> \n    </span>\n  </div>`}\n    ${`<form class="${f}" id="${O.settingsModalFormId}">`}\n    ${J(V)}\n    ${J(q)}\n    ${J(G)}\n    ${R(N)}\n    ${R(P)}\n    ${R(j)}\n    ${n}\n    </form>\n    ${function(e,t){return`<div class="${g} ${b} ${_}">\n      <a class="${m}" href="${e.websiteUrl}" target="_blank">${e.websiteLabel}</a>\n      <label class="${D} ${E}">\n        <input type="checkbox" \n                id="${e.id}" \n                class="${S}"\n                name="${e.name}" \n                value="${"banner"===t.mode?e.checkedValue:e.uncheckedValue}"\n                data-checked-value="${e.checkedValue}"\n                data-unchecked-value="${e.uncheckedValue}"\n                ${"banner"===t.mode?"checked":""}>\n                <span>${"banner"===t.mode?e.simulator:e.banner}</span>\n      </label>\n  </div>`}(K,e)}\n    </div>`};let X,z;function H(e){X=e.offsetX,z=e.offsetY,e.dataTransfer.setData("text/plain",e.target.id)}function Y(e){e.preventDefault()}function W(e){try{const t=JSON.parse(sessionStorage.getItem(e));Object.keys(B).forEach((e=>{const n=B[e];!function(e,t){const n=[...document.querySelector(`.${f}`).querySelectorAll(e)].find((e=>e.id===t));if(!n)return;n.setAttribute("checked","");const{value:o}=n,a=n.closest(`.${y}`).querySelector(`.${M}`);a&&(a.innerHTML=o)}(`#${n.id} input`,`${n.valuePrefix}-${t[e]}`)})),Object.keys(F).forEach((t=>{!function(e,t,n){try{const o=JSON.parse(sessionStorage.getItem(n)),a=document.querySelector(`.${f}`).querySelector(`#${e}`);if("false"===o[t])return;a.setAttribute("checked","checked")}catch(e){console.log("Unable to parse modal settings",e)}}(F[t].id,t,e)}))}catch(e){console.log("Unable to parse modal settings",e)}}function Q(e){e.stopPropagation(),e.preventDefault();!function(e){"checked"===e.getAttribute("checked")?e.removeAttribute("checked","false"):e.setAttribute("checked","checked")}(e.target.parentElement.querySelector("input"))}function ee(e){const t=[...e],n=[...Object.keys(B),...Object.keys(F)],o=function(e){const t=window.location.search;if(!t)return;return t.replace("?","").split("&").map((e=>e.split("="))).filter((t=>!e.includes(t[0])))}(n)||[],a=n.map((e=>t.find((t=>t[0]===e))||[e,F[e].uncheckedValue]));return[...o,...a].map((e=>`${e[0]}=${e[1]}`)).join("&")}function te(e){e.preventDefault();!function(e){const t=`${window.location.href.split("?")[0]}?${e}`;window.location.href=t}(ee(new FormData(document.getElementById(O.settingsModalFormId))))}function ne(e){const t=document.querySelector(`.${E} span`),n=e?K.simulator:K.banner;t.textContent=n}function oe(e,t,n){const a=e.querySelector(`.${I}`),s=e.querySelector(`.${A}`),l=e.querySelector(`.${_} .${D}`);a.addEventListener("click",(()=>function(e,t,n){e.classList.remove(`${d}`),e.classList.add(`${r}`);const a={...t};a.mode="open",o(a,n)}(e,t,n))),s.addEventListener("click",(()=>function(e,t,n){e.classList.remove(`${r}`),e.classList.remove(`${c}`),e.classList.add(`${d}`);const a={...t};a.mode="closed",o(a,n)}(e,t,n))),l.addEventListener("click",(a=>function(e,t,n,a){if(e.stopPropagation(),e.preventDefault(),"checked"===e.target.parentElement.querySelector("input").getAttribute("checked")){t.classList.add(`${c}`);const e={...n};return e.mode="banner",o(e,a),void ne(1)}t.classList.remove(`${c}`);const s={...n};s.mode="open",o(s,a),ne(0)}(a,e,t,n)))}function ae(e,t,n){e.addEventListener("dragstart",H,0),document.body.addEventListener("dragover",Y,0),document.body.addEventListener("drop",(e=>function(e,t,n){e.preventDefault(),e.stopPropagation();const a=e.dataTransfer.getData("text"),s=document.getElementById(a),l=e.pageX-X,i=e.pageY-z;var r,d,c;d=l,c=i,(r=s).style.top=`${c}px`,r.style.left=`${d}px`;const u={...t};u.posTop=i,u.posLeft=l,o(u,n),e.dataTransfer.clearData()}(e,t,n)),0)}const se=e=>{const{defaultDevSettings:t,sessionStorageKey:n,sessionStorageDevKey:o}=e;W(n),function(){const e=document.querySelectorAll(`.${D}`),t=document.getElementById(O.settingsModalSubmitId);e.forEach((e=>{e.addEventListener("click",Q)})),t.addEventListener("click",te)}();const a=document.querySelector(`.${i}`);oe(a,t,o),t.isDraggable&&ae(a,t,o)},le={settings:{lowRAM:4,lowCPU:4,slowConnectionTypes:["slow-2g","2g","3g"]},sessionStorageKey:"progressiveUserSettings",sessionStorageDevKey:"progressiveUserDevSettings",defaultDevSettings:{isDraggable:1,mode:"closed",posTop:20,posLeft:20}},ie=o=>{const l={...le,...o},{sessionStorageKey:i,sessionStorageDevKey:r,defaultDevSettings:d}=l,c=(()=>{const e=new URLSearchParams(window.location.search).entries(),t={};return[...e].forEach((e=>{const[n,o]=e;t[n]=o})),t})(),u=n(i),p=n(r),g=t(i)?(t=>{const{slowConnectionTypes:n}=t;return{connectionSpeed:e(n)}})(l.settings):s(l.settings),m=Object.assign(u,g,c);a(m,i),window.addEventListener("load",(()=>{const e=Object.keys(p).length?p:d;document.body.insertAdjacentHTML("afterbegin",Z(e)),se(l)}))};window.progUXdev=ie}();
