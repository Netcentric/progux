!function(){"use strict";const e=e=>"connection"in navigator?e.indexOf(navigator.connection.effectiveType)>=0?"slow":"fast":"unknown",t=e=>null!==sessionStorage.getItem(e),n=e=>{try{return t(e)?JSON.parse(sessionStorage.getItem(e)):{}}catch(e){return console.log(e),0}},o=(e,t)=>{try{sessionStorage.setItem(t,JSON.stringify(e))}catch(e){console.log(e)}};const a=(e,t)=>{o(e,t),function(e){const t=n(e),o=document.getElementsByTagName("html")[0];Object.entries(t).forEach((e=>{const[t,n]=e,a=`${t}-${n}`;o.classList.add(a)}))}(t)},s=t=>{const{lowRAM:n,lowCPU:o,slowConnectionTypes:a}=t;return{memoryLevel:(e=>{if(!("deviceMemory"in navigator))return"unknown";const t=navigator.deviceMemory;return t===e?"mid":t>e?"high":"low"})(n),cpuLevel:(e=>{if(!("hardwareConcurrency"in navigator))return"unknown";const t=navigator.hardwareConcurrency;return t===e?"mid":t>e?"high":"low"})(o),connectionSpeed:e(a),saveData:"connection"in navigator?navigator.connection.saveData:0,reducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches,doNotTrack:(()=>{const e="doNotTrack"in navigator,t="1"===navigator.doNotTrack;return e&&t})()}},l="settingsModal",i=l,c="settingsModal--open",r="settingsModal--closed",d="settingsModal--banner",u="settingsModal__header",g="settingsModal__logo",p="settingsModal__footer",m="settingsModal__footerLink",v="settingsModal__title",$="settingsModal__form",f="settingsModal__submit",h="settingsModal__options",y="settingsModal__option",b="settingsModal__controller",w="settingsModal__controller--toggle",k="settingsModal__controller--options",M="settingsModal__controller--view",_="settingsModal__parameter",S="settingsModal__parameterValue",L="settingsModal__parameterInput",D="settingsModal__input",E="settingsModal__label",T="settingsModal__toggle",I="settingsModal__toggle--view",x="settingsModal__slider",V="settingsModal__icon",U="settingsModal__closeIcon",P="settingsModal__openIcon",C="assets/Symbol_ProgUX.svg",q="ProgUX logo symbol",O="ProgUX logo symbol",A="assets/Modal_Icon.svg",N="Cog icon",j="Cog icon",B={settingsModalSubmitId:"settingsModalSubmit",settingsModalFormId:"settingsModalForm"},K={title:"memory level",id:"settingsModalMemoryLevel",valuePrefix:"memory-level",options:[{type:"radio",id:"memory-level-low",name:"memoryLevel",value:"low",label:"low"},{type:"radio",id:"memory-level-mid",name:"memoryLevel",value:"mid",label:"mid"},{type:"radio",id:"memory-level-high",name:"memoryLevel",value:"high",label:"high"},{type:"radio",id:"memory-level-unknown",name:"memoryLevel",value:"unknown",label:"unknown"}]},X={title:"CPU level",id:"settingsModalCpuLevel",valuePrefix:"cpu-level",options:[{type:"radio",id:"cpu-level-low",name:"cpuLevel",value:"low",label:"low"},{type:"radio",id:"cpu-level-mid",name:"cpuLevel",value:"mid",label:"mid"},{type:"radio",id:"cpu-level-high",name:"cpuLevel",value:"high",label:"high"},{type:"radio",id:"cpu-level-unknown",name:"cpuLevel",value:"unknown",label:"unknown"}]},F={title:"Connection speed",id:"settingsModalConnectionSpeed",valuePrefix:"connection-speed",options:[{type:"radio",id:"connection-speed-slow",name:"connectionSpeed",value:"slow",label:"slow"},{type:"radio",id:"connection-speed-fast",name:"connectionSpeed",value:"fast",label:"fast"},{type:"radio",id:"connection-speed-unknown",name:"connectionSpeed",value:"unknown",label:"unknown"}]},J={title:"Save data",id:"saveData",name:"saveData",value:"true",checkedValue:"true",uncheckedValue:"false"},R={title:"Reduced motion",id:"reducedMotion",name:"reducedMotion",value:"true",checkedValue:"true",uncheckedValue:"false"},H={title:"Do not track",id:"doNotTrack",name:"doNotTrack",value:"true",checkedValue:"true",uncheckedValue:"false"},Y={memoryLevel:K,cpuLevel:X,connectionSpeed:F},z={saveData:J,reducedMotion:R,doNotTrack:H},G={websiteLabel:"www.progux.org",websiteUrl:"http://progux.org/",banner:"Banner view",simulator:"Simulator view",id:"view",name:"view",value:"disabled",checkedValue:"enabled",uncheckedValue:"disabled"};function Q(e){const t=function(e){let t="";return e.forEach((e=>{t+=`<li class="${y}">\n        <input type="${e.type}" id="${e.id}" class="${D}" name="${e.name}" value="${e.value}">\n        <label for="${e.id}" class="${E}">${e.label}</label>\n    </li>`})),t}(e.options);return`<div class="${b} ${k}">\n    <p class="${_}">${e.title}</p>\n    <p class="${S}"></p>\n    <ul class="${h} ${L}" id="${e.id}">\n        ${t}\n    </ul>\n  </div>`}function W(e){return`<div class="${b} ${w}">\n    <p class="${_}">${e.title}</p>\n    <p class="${S}">${e.value}</p>\n    <label class="${T} ${L}">\n      <input type="checkbox" \n              id="${e.id}" \n              class="${D}"\n              name="${e.name}" \n              value="${e.value}"\n              data-checked-value="${e.checkedValue}"\n              data-unchecked-value="${e.uncheckedValue}">\n      <span class="${x}"></span>\n    </label>\n  </div>`}const Z=e=>{const t=function(e){const{mode:t,posTop:n,posLeft:o,isDraggable:a}=e;let s="closed"===t?`${i}--closed`:`${i}--open`;return"banner"===t&&(s+=` ${i}--banner`),`<div class="${i} ${s}"\n               style="top: ${n}px; left: ${o}px;"\n               id="${i}" \n               draggable="${a?"true":"false"}">`}(e),n=`<button type="submit" class="${f}" id="${B.settingsModalSubmitId}" value="Submit">Update</button>`;return`${t}\n    ${`<div class="${u}">\n    <img class="${g}" src="${C}" alt="${q}" title="${O}" width="40" height="40">\n    <p class="${v}">Simulator</p>\n    <span class="${V} ${U}">\n      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 30 30">\n  <path fill-rule="evenodd" d="M30 3.021L26.979 0 15 11.979 3.021 0 0 3.021 11.979 15 0 26.979 3.021 30 15 18.021 26.979 30 30 26.979 18.021 15z"/>\n</svg>\n    </span>\n    <img class="${V} ${P}" src="${A}" alt="${N}" title="${j}" width="50" height="50">\n  </div>`}\n    ${`<form class="${$}" id="${B.settingsModalFormId}">`}\n    ${Q(K)}\n    ${Q(X)}\n    ${Q(F)}\n    ${W(J)}\n    ${W(R)}\n    ${W(H)}\n    ${n}\n    </form>\n    ${function(e,t){return`<div class="${p} ${w} ${M}">\n      <a class="${m}" href="${e.websiteUrl}" target="_blank">${e.websiteLabel}</a>\n      <label class="${T} ${I}">\n        <input type="checkbox" \n                id="${e.id}" \n                class="${D}"\n                name="${e.name}" \n                value="${"banner"===t.mode?e.checkedValue:e.uncheckedValue}"\n                data-checked-value="${e.checkedValue}"\n                data-unchecked-value="${e.uncheckedValue}"\n                ${"banner"===t.mode?"checked":""}>\n                ${"banner"===t.mode?e.simulator:e.banner}\n      </label>\n  </div>`}(G,e)}\n    </div>`};let ee,te;function ne(e){ee=e.offsetX,te=e.offsetY,e.dataTransfer.setData("text/plain",e.target.id)}function oe(e){e.preventDefault()}function ae(e){try{const t=JSON.parse(sessionStorage.getItem(e));Object.keys(Y).forEach((e=>{const n=Y[e];!function(e,t){const n=[...document.querySelector(`.${$}`).querySelectorAll(e)].find((e=>e.id===t));if(!n)return;n.setAttribute("checked","");const{value:o}=n,a=n.closest(`.${b}`).querySelector(`.${S}`);a&&(a.innerHTML=o)}(`#${n.id} input`,`${n.valuePrefix}-${t[e]}`)})),Object.keys(z).forEach((t=>{!function(e,t,n){try{const o=JSON.parse(sessionStorage.getItem(n)),a=document.querySelector(`.${$}`).querySelector(`#${e}`);if("false"===o[t])return;a.setAttribute("checked","checked")}catch(e){console.log("Unable to parse modal settings",e)}}(z[t].id,t,e)}))}catch(e){console.log("Unable to parse modal settings",e)}}function se(e){e.stopPropagation(),e.preventDefault();!function(e){"checked"===e.getAttribute("checked")?e.removeAttribute("checked","false"):e.setAttribute("checked","checked")}(e.target.parentElement.querySelector("input"))}function le(e){const t=[...e],n=[...Object.keys(Y),...Object.keys(z)],o=function(e){const t=window.location.search;if(!t)return;return t.replace("?","").split("&").map((e=>e.split("="))).filter((t=>!e.includes(t[0])))}(n)||[],a=n.map((e=>t.find((t=>t[0]===e))||[e,z[e].uncheckedValue]));return[...o,...a].map((e=>`${e[0]}=${e[1]}`)).join("&")}function ie(e){e.preventDefault();!function(e){const t=`${window.location.href.split("?")[0]}?${e}`;window.location.href=t}(le(new FormData(document.getElementById(B.settingsModalFormId))))}function ce(e,t,n){const a=e.querySelector(`.${P}`),s=e.querySelector(`.${U}`),l=e.querySelector(`.${M} .${T}`);a.addEventListener("click",(()=>function(e,t,n){e.classList.remove(`${r}`),e.classList.add(`${c}`);const a={...t};a.mode="open",o(a,n)}(e,t,n))),s.addEventListener("click",(()=>function(e,t,n){e.classList.remove(`${c}`),e.classList.remove(`${d}`),e.classList.add(`${r}`);const a={...t};a.mode="closed",o(a,n)}(e,t,n))),l.addEventListener("click",(a=>function(e,t,n,a){if(e.stopPropagation(),e.preventDefault(),"checked"===e.target.parentElement.querySelector("input").getAttribute("checked")){t.classList.add(`${d}`);const e={...n};return e.mode="banner",void o(e,a)}t.classList.remove(`${d}`);const s={...n};s.mode="open",o(s,a)}(a,e,t,n)))}function re(e,t,n){e.addEventListener("dragstart",ne,0),document.body.addEventListener("dragover",oe,0),document.body.addEventListener("drop",(e=>function(e,t,n){e.preventDefault(),e.stopPropagation();const a=e.dataTransfer.getData("text"),s=document.getElementById(a),l=e.pageX-ee,i=e.pageY-te;var c,r,d;r=l,d=i,(c=s).style.top=`${d}px`,c.style.left=`${r}px`;const u={...t};u.posTop=i,u.posLeft=l,o(u,n),e.dataTransfer.clearData()}(e,t,n)),0)}const de=e=>{const{defaultDevSettings:t,sessionStorageKey:n,sessionStorageDevKey:o}=e;ae(n),function(){const e=document.querySelectorAll(`.${T}`),t=document.getElementById(B.settingsModalSubmitId);e.forEach((e=>{e.addEventListener("click",se)})),t.addEventListener("click",ie)}();const a=document.querySelector(`.${i}`);ce(a,t,o),t.isDraggable&&re(a,t,o)},ue={settings:{lowRAM:4,lowCPU:4,slowConnectionTypes:["slow-2g","2g","3g"]},sessionStorageKey:"progressiveUserSettings",sessionStorageDevKey:"progressiveUserDevSettings",defaultDevSettings:{isDraggable:1,mode:"closed",posTop:20,posLeft:20}},ge=o=>{const l={...ue,...o},{sessionStorageKey:i,sessionStorageDevKey:c,defaultDevSettings:r}=l,d=(()=>{const e=new URLSearchParams(window.location.search).entries(),t={};return[...e].forEach((e=>{const[n,o]=e;t[n]=o})),t})(),u=n(i),g=n(c),p=t(i)?(t=>{const{slowConnectionTypes:n}=t;return{connectionSpeed:e(n)}})(l.settings):s(l.settings),m=Object.assign(u,p,d);a(m,i),window.addEventListener("load",(()=>{const e=Object.keys(g).length?g:r;document.body.insertAdjacentHTML("afterbegin",Z(e)),de(l)}))};window.progUXdev=ge}();
